<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title><%= documentTitle %></title>
    <style>
        @page {
            margin: 2cm 2cm 2cm 2cm;
            size: A4;
        }
        
        body { 
            font-family: 'Times New Roman', serif; 
            margin: 0; 
            padding: 0;
            font-size: 12px;
            line-height: 1.6;
            color: #000;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 0;
            margin-bottom: 40px;
            min-height: 120px;
        }
        
        .header-left, .header-right {
            width: 40%;
            font-size: 10px;
            font-weight: bold;
            text-align: center;
            line-height: 1.2;
        }
        
        .header-center {
            text-align: center;
            width: 20%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .header-center img {
            max-width: 100px;
            height: auto;
        }
        
        .separator {
            margin: 3px 0;
            color: #000;
        }
        
        .header-section {
            margin-bottom: 2px;
        }
        
        .note-title {
            text-align: center;
            margin: 50px 0 20px 0;
        }
        
        .document-title {
            text-align: center;
            font-size: 15px;
            font-weight: bold;
            color: #000;
            line-height: 1.3;
        }

        .document-title p {
            margin: 5px 0;
        }

        .body-content {
            text-align: justify;
            line-height: 1.8;
            margin: 0 1cm;
            font-size: 14px;
        }
        
        .body-content p {
            text-indent: 1.5cm;
            margin-bottom: 15px;
        }
        
        .body-content p:first-child {
            text-indent: 1.5cm;
        }

        .rotations-section {
            margin: 20px 1cm;
            padding: 15px;
            border: 1px solid #000;
            background-color: #f9f9f9;
        }

        .rotations-title {
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            text-decoration: underline;
            font-size: 14px;
        }

        .rotation-item {
            margin: 10px 0;
            padding-left: 20px;
            line-height: 1.6;
            font-size: 12px;
        }

        .rotation-periode {
            font-weight: bold;
        }

        .rotation-service {
            margin-left: 10px;
        }

        .first-page-container {
            position: relative;
            min-height: calc(297mm - 4cm);
        }

        /* CORRECTION: align-items: flex-start pour aligner les deux colonnes par le haut */
        .first-page-footer {
            display: flex;
            justify-content: space-between;
            align-items: flex-start; /* MODIFICATION ICI pour aligner par le haut */
            margin-top: 60px;
            page-break-inside: avoid;
        }

        .footer-left {
            flex: 1;
            margin-left: 1cm;
        }

        .footer-right {
            flex: 0 0 200px;
            margin-right: 1cm;
        }

        .copie-section {
            font-size: 14px;
        }
        
        .copie-title {
            font-weight: bold;
            text-decoration: underline;
            margin-bottom: 15px;
        }
        
        .copie-list {
            margin-left: 20px;
            line-height: 1.6;
        }

        .verification-section {
            text-align: center;
            padding: 10px;
            /* border: 2px solid #000; */
            background-color: #fff;
        }
        
        .qr-code-container {
            margin-bottom: 8px;
        }
        
        .qr-code-container img {
            width: 130px;
            height: 130px;
            display: block;
            margin: 0 auto;
        }
        
        .reference-systeme {
            font-size: 10px;
            font-weight: bold;
            margin-top: 8px;
            text-align: center;
        }
        
        .verification-text {
            font-size: 8px;
            color: #666;
            margin-top: 5px;
            text-align: center;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .first-page-footer {
                page-break-inside: avoid;
            }
        }

        .highlight {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="first-page-container">
        <div class="header">
            <div class="header-left">
                <div class="header-section">REPUBLIQUE DU CAMEROUN</div>
                <div class="header-section">Paix-Travail-Patrie</div>
                <div class="separator">----------------------</div>
                <div class="header-section">MINISTERE DES FINANCES</div>
                <div class="separator">----------------------</div>
                <div class="header-section">DIRECTION GENERALE DES IMPOTS</div>
                <div class="separator">----------------------</div>
                <div class="header-section">DIRECTION DES AFFAIRES GENERALES</div>
                <div class="separator">----------------------</div>
                <div class="header-section">CELLULE DU PERFECTIONNEMENT ET DE</div>
                <div class="header-section">LA FORMATION CONTINUE</div>
                <div class="separator">----------------------</div>
            </div>
            
            <div class="header-center">
                <% if (logoUrl) { %>
                    <img src="<%= logoUrl %>" alt="Armoiries du Cameroun">
                <% } %>
            </div>
            
            <div class="header-right">
                <div class="header-section">REPUBLIC OF CAMEROON</div>
                <div class="header-section">Peace-Work-Fatherland</div>
                <div class="separator">----------------------</div>
                <div class="header-section">MINISTRY OF FINANCE</div>
                <div class="separator">----------------------</div>
                <div class="header-section">DIRECTORATE GENERAL OF TAXATION</div>
                <div class="separator">----------------------</div>
                <div class="header-section">DEPARTMENT OF GENERAL AFFAIRS</div>
                <div class="separator">----------------------</div>
                <div class="header-section">TRAINING AND SKILLS PERFECTION UNIT</div>
                <div class="separator">----------------------</div>
            </div>
        </div>
        
        <div class="note-title">
            <h3 class="document-title">
                <p>Note de service N°_____________ MINFI/DGI/DAG/CPFC du _____________</p>
                <p><%= noteTitle %></p>
            </h3>
        </div>

        <div class="body-content">        
            <p>
                <span class="highlight"><%= userSexe %> <%= userFullName %></span>, <%= etudiant %> en
                <%= niveau %> de la filière <%= filiere %> à <span class="highlight"><%= userUniversity %></span>,
                est <%= mise %> en stage académique auprès des structures de la Direction Générale des Impôts 
                du <%= dateDebutStage %> au <%= dateFinStage %>, suivant le calendrier ci-après :
            </p>
        </div>

        <div class="rotations-section">
            <div class="rotations-title">CALENDRIER DES ROTATIONS</div>
            <% rotations.forEach(function(rotation) { %>
                <div class="rotation-item">
                    <span class="rotation-periode">- <%= rotation.periode %> :</span>
                    <span class="rotation-service"><%= rotation.service %></span>
                </div>
            <% }); %>
        </div>

        <div class="body-content">
            <p>
                Chaque Chef de Service accueillant <%= stagiaire %> désignera un tuteur pour l'encadrement 
                et le suivi <%= leditStagiaire %> durant la période de rotation dans son service.
            </p>
            
            <p>
                A l'issue de la période de stage, <%= stagiaire %> soumettra au Directeur Général des Impôts 
                un rapport global y afférent.
            </p>
            
            <p>
                <%= directeursEnCharge %> sont chargés, chacun en ce qui le concerne, de la mise en œuvre 
                des termes de la présente note de service.
            </p>
        </div>

        <div class="first-page-footer">
            <div class="footer-left">
                <div class="copie-section">
                    <div class="copie-title">Copie :</div>
                    <div class="copie-list">
                        <% if (copies && copies.length > 0) { %>
                            <% copies.forEach(function(copie) { %>
                                <% if (copie.trim()) { %>
                                    - <%= copie.trim() %><br>
                                <% } %>
                            <% }); %>
                        <% } else { %>
                            - Intéressé(e)<br>
                            - Directeurs concernés<br>
                            - Archives/Chrono.
                        <% } %>
                    </div>
                </div>
            </div>

            <div class="footer-right">
                <div class="verification-section">
                    <div class="qr-code-container">
                        <img src="<%= qrCodeUrl %>" alt="QR Code de vérification">
                    </div>
                    <div class="reference-systeme">
                        Réf. Système: <%= referenceSysteme %>
                    </div>
                    <div class="verification-text">
                        Scanner pour vérifier l'authenticité
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>